---
import MaskHeader from "@components/header/headerMask.astro";
import BackTo from "@components/backTo.astro";
import Tab from "@components/tab.astro";
import "../styles/main.css";

interface Props {
  title?: string;
}
const { title } = Astro.props;
const isWikiPage = Astro.url.pathname.startsWith('/wiki');
---

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{title}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/favicon.png" />
  </head>
  <body id="pageLayout" class="themeBase">
    <!-- Floating particles background -->
    <div class="floating-particles">
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
    </div>
    
    <MaskHeader />
    <main class="relative grid grid-cols-[1fr_min(65ch,90%)_1fr]">
      <article class="min-h-screen relative col-start-2 col-end-3">
        <div class="mt-20 mb-20 lg:mt-25 lg:mb-20 w-full">
          <div
            class:list={[
              {
                hidden: !["posts", "projects", "wiki"].includes(
                  Astro.url.pathname.split('/')[1]
                ),
              },
            ]}
          >
            <BackTo backTo="" />
            {!isWikiPage && <Tab />}
          </div>
          <slot />
        </div>
      </article>
    </main>
  </body>
</html>

<style is:global>
  body {
    position: relative;
    width: 100%;
    min-height: 100vh;
    overflow-x: hidden;
  }
  
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -10;
    opacity: 0.03;
    background-image: 
      radial-gradient(circle at 25% 25%, #5F7470 1px, transparent 1px),
      radial-gradient(circle at 75% 75%, #889696 1px, transparent 1px),
      radial-gradient(circle at 50% 50%, #B8BDB5 0.5px, transparent 0.5px);
    background-size: 50px 50px, 80px 80px, 30px 30px;
    background-position: 0 0, 25px 25px, 10px 10px;
    animation: noiseMove 20s linear infinite;
  }
  
  body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -9;
    background: 
      linear-gradient(45deg, transparent 48%, rgba(95, 116, 112, 0.01) 49%, rgba(95, 116, 112, 0.01) 51%, transparent 52%),
      linear-gradient(-45deg, transparent 48%, rgba(136, 150, 150, 0.01) 49%, rgba(136, 150, 150, 0.01) 51%, transparent 52%);
    background-size: 20px 20px, 25px 25px;
    animation: noiseShift 15s ease-in-out infinite alternate;
  }
  
  @keyframes noiseMove {
    0% { transform: translate(0, 0) rotate(0deg); }
    25% { transform: translate(-2px, 2px) rotate(0.5deg); }
    50% { transform: translate(2px, -1px) rotate(-0.5deg); }
    75% { transform: translate(-1px, -2px) rotate(0.3deg); }
    100% { transform: translate(0, 0) rotate(0deg); }
  }
  
  @keyframes noiseShift {
    0% { opacity: 0.01; transform: scale(1); }
    50% { opacity: 0.02; transform: scale(1.01); }
    100% { opacity: 0.01; transform: scale(1); }
  }
  
  /* Floating particles effect */
  .floating-particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -8;
  }
  
  .particle {
    position: absolute;
    width: 2px;
    height: 2px;
    background: radial-gradient(circle, rgba(95, 116, 112, 0.3), transparent);
    border-radius: 50%;
    animation: float 6s ease-in-out infinite;
  }
  
  .particle:nth-child(1) { top: 20%; left: 10%; animation-delay: 0s; animation-duration: 8s; }
  .particle:nth-child(2) { top: 60%; left: 80%; animation-delay: 2s; animation-duration: 6s; }
  .particle:nth-child(3) { top: 80%; left: 30%; animation-delay: 4s; animation-duration: 10s; }
  .particle:nth-child(4) { top: 30%; left: 70%; animation-delay: 1s; animation-duration: 7s; }
  .particle:nth-child(5) { top: 50%; left: 20%; animation-delay: 3s; animation-duration: 9s; }
</style>
